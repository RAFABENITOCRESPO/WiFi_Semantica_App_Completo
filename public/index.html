<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>WiFi Sem√°ntica App</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    #map { height: 500px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Explora Puntos WiFi</h1>
  <form id="filterForm">
    <select name="city">
      <option value="Buenos Aires">Buenos Aires</option>
      <option value="New York">New York</option>
    </select>
    <select name="type">
      <option value="">Tipo</option>
      <option value="Free">Gratis</option>
      <option value="Commercial">Comercial</option>
    </select>
    <select name="coverage">
      <option value="">Cobertura</option>
      <option value="High">Alta</option>
      <option value="Medium">Media</option>
      <option value="Low">Baja</option>
    </select>
    <button type="submit">Buscar</button>
  </form>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const form = document.getElementById('filterForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const params = new URLSearchParams(new FormData(form)).toString();
      const response = await fetch(`/api/wifi?${params}`);
      const data = await response.json();
      showMap(data);
    });

    function showMap(points) {
      const map = L.map('map').setView([0, 0], 2);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);
      points.forEach(p => {
        L.marker([p.lat, p.lon]).addTo(map).bindPopup(p.ssid || "Punto WiFi");
      });
    }
  </script>
</body>
</html>